{"version":3,"file":"variants.global.dev.js","sources":["../src/variants.ts"],"sourcesContent":["/**\n * @module @twind/preset-tailwind/variants\n */\n\nimport {\n  AutocompleteProvider,\n  VariantResolver,\n  Variant,\n  AutocompleteItem,\n  arbitrary,\n} from '@twind/core'\nimport type { TailwindTheme } from './types'\n\nimport { DEV } from 'distilt/env'\n\nimport { normalize, withAutocomplete } from '@twind/core'\n\n// indirection wrapper to remove autocomplete functions from production bundles\nfunction withAutocomplete$(\n  rule: VariantResolver<TailwindTheme>,\n  autocomplete: AutocompleteProvider<TailwindTheme> | false,\n): VariantResolver<TailwindTheme> {\n  if (DEV) {\n    return withAutocomplete(rule, autocomplete)\n  }\n\n  return rule\n}\n\nconst variants: Variant<TailwindTheme>[] = [\n  ['sticky', '@supports ((position: -webkit-sticky) or (position:sticky))'],\n  ['motion-reduce', '@media (prefers-reduced-motion:reduce)'],\n  ['motion-safe', '@media (prefers-reduced-motion:no-preference)'],\n  ['print', '@media print'],\n  ['(portrait|landscape)', ({ 1: $1 }) => `@media (orientation:${$1})`],\n  ['contrast-(more|less)', ({ 1: $1 }) => `@media (prefers-contrast:${$1})`],\n\n  ['(first-(letter|line)|placeholder|backdrop|before|after)', ({ 1: $1 }) => `&::${$1}`],\n  ['(marker|selection)', ({ 1: $1 }) => `& *::${$1},&::${$1}`],\n  ['file', '&::file-selector-button'],\n\n  ['(first|last|only)', ({ 1: $1 }) => `&:${$1}-child`],\n  ['even', '&:nth-child(2n)'],\n  ['odd', '&:nth-child(odd)'],\n\n  ['open', '&[open]'],\n\n  // All other pseudo classes are already supported by twind\n\n  [\n    '(aria|data)-',\n    withAutocomplete$(\n      ({ 1: $1 /* aria or data */, $$ /* everything after the dash */ }, context) =>\n        $$ &&\n        `&[${$1}-${\n          // aria-asc or data-checked -> from theme\n          context.theme($1, $$) ||\n          // aria-[...] or data-[...]\n          arbitrary($$, '', context) ||\n          // default handling\n          `${$$}=\"true\"`\n        }]`,\n      DEV &&\n        (({ 1: $1 }, { theme }) =>\n          [\n            ...new Set([\n              ...($1 == 'aria'\n                ? [\n                    'checked',\n                    'disabled',\n                    'expanded',\n                    'hidden',\n                    'pressed',\n                    'readonly',\n                    'required',\n                    'selected',\n                  ]\n                : []),\n              ...Object.keys(theme($1 as 'aria' | 'data') || {}),\n            ]),\n          ]\n            .map(\n              (key): AutocompleteItem => ({\n                suffix: key,\n                label: `&[${$1}-${theme($1, key) || `${key}=\"true\"`}]`,\n                theme: { section: $1, key },\n              }),\n            )\n            .concat([{ suffix: '[', label: `&[${$1}-…]` }])),\n    ),\n  ],\n\n  /* Styling based on parent and peer state */\n  // Groups classes like: group-focus and group-hover\n  // these need to add a marker selector with the pseudo class\n  // => '.group:focus .group-focus:selector'\n  [\n    '((group|peer)(~[^-[]+)?)(-\\\\[(.+)]|[-[].+?)(\\\\/.+)?',\n    withAutocomplete$(\n      ({ 2: type, 3: name = '', 4: $4, 5: $5 = '', 6: label = name }, { e, h, v }) => {\n        const selector = normalize($5) || ($4[0] == '[' ? $4 : (v($4.slice(1)) as string))\n\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        return `${(selector.includes('&') ? selector : '&' + selector).replace(\n          /&/g,\n          `:merge(.${e(h(type + label))})`,\n        )}${type[0] == 'p' ? '~' : ' '}&`\n      },\n      DEV &&\n        ((_, { variants }) =>\n          Object.entries(variants)\n            .filter(([, selector]) => /^&(\\[|:[^:])/.test(selector))\n            .flatMap(([variant, selector]): AutocompleteItem[] => [\n              {\n                prefix: 'group-',\n                suffix: variant,\n                label: `${selector.replace('&', '.group')} &`,\n                modifiers: [],\n              },\n              {\n                prefix: 'peer-',\n                suffix: variant,\n                label: `${selector.replace('&', '.peer')} &`,\n                modifiers: [],\n              },\n            ])),\n    ),\n  ],\n\n  // direction variants\n  [\n    '(ltr|rtl)',\n    withAutocomplete$(\n      ({ 1: $1 }) => `[dir=\"${$1}\"] &`,\n      DEV && (({ 1: $1 }) => [{ prefix: $1, suffix: '', label: `[dir=\"${$1}\"] &` }]),\n    ),\n  ],\n\n  [\n    'supports-',\n    withAutocomplete$(\n      ({ $$ /* everything after the dash */ }, context) => {\n        $$ &&= (context.theme('supports', $$) || arbitrary($$, '', context)) as string\n\n        if ($$) {\n          if (!$$.includes(':')) {\n            $$ += ':var(--tw)'\n          }\n\n          if (!/^\\w*\\s*\\(/.test($$)) {\n            $$ = `(${$$})`\n          }\n\n          // Chrome has a bug where `(condtion1)or(condition2)` is not valid\n          // But `(condition1) or (condition2)` is supported.\n          return `@supports ${$$.replace(/\\b(and|or|not)\\b/g, ' $1 ').trim()}`\n        }\n      },\n      DEV &&\n        ((_, { theme }) =>\n          Object.keys(theme('supports') || {})\n            .map(\n              (key): AutocompleteItem => ({\n                suffix: key,\n                theme: { section: 'supports', key },\n              }),\n            )\n            .concat([{ suffix: '[', label: `@supports …` }])),\n    ),\n  ],\n\n  [\n    'max-',\n    withAutocomplete$(\n      ({ $$ }, context) => {\n        $$ &&= (context.theme('screens', $$) || arbitrary($$, '', context)) as string\n        if (typeof $$ == 'string') {\n          return `@media not all and (min-width:${$$})`\n        }\n      },\n      DEV &&\n        ((_, { theme }) =>\n          Object.entries(theme('screens') || {})\n            .filter(([, value]) => typeof value == 'string')\n            .map(\n              ([key, value]): AutocompleteItem => ({\n                suffix: key,\n                label: `@media not all and (min-width:${value})`,\n                theme: { section: 'screens', key },\n              }),\n            )\n            .concat([{ suffix: '[', label: `@media not all and (min-width: …)` }])),\n    ),\n  ],\n\n  [\n    'min-',\n    withAutocomplete$(({ $$ }, context) => {\n      $$ &&= arbitrary($$, '', context) as string\n      return $$ && `@media (min-width:${$$})`\n    }, DEV && (() => [{ suffix: '[', label: `@media (min-width: …)` }])),\n  ],\n\n  // Arbitrary variants\n  [/^\\[(.+)]$/, ({ 1: $1 }) => /[&@]/.test($1) && normalize($1).replace(/[}]+$/, '').split('{')],\n]\n\nexport default variants\n"],"names":["twind","presetTailwind_variants","core","withAutocomplete$","rule","autocomplete","withAutocomplete","variants","$1","$$","context","theme","arbitrary","Set","Object","keys","map","key","suffix","label","section","concat","type","name","$4","$5","e","h","v","selector","normalize","slice","includes","replace","_","entries","filter","test","flatMap","variant","prefix","modifiers","trim","value","split"],"mappings":"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"}