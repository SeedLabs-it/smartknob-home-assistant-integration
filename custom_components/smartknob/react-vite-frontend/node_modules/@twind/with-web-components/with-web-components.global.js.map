{"version":3,"file":"with-web-components.global.js","sources":["../../../node_modules/.pnpm/@swc+helpers@0.4.14/node_modules/@swc/helpers/src/_extends.mjs","../src/index.ts"],"sourcesContent":["function extends_() {\n  extends_ = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return extends_.apply(this, arguments);\n}\n\nexport default function _extends() {\n  return extends_.apply(this, arguments);\n}\n","import {\n  twind,\n  cssom,\n  mo as observe,\n  noop,\n  type Sheet,\n  type TwindConfig,\n  type TwindUserConfig,\n} from '@twind/core'\n\nimport { PROD } from 'distilt/env'\n\nexport default function install(\n  config: TwindConfig<any> | TwindUserConfig<any>,\n  isProduction = PROD,\n) {\n  // 1. Create separate adoptable sheet\n  const sheet = adoptable()\n\n  // 2. Use that to create an own twind instance\n  const tw = twind(\n    {\n      ...config,\n      // in production use short hashed class names\n      hash: config.hash ?? isProduction,\n    } as TwindConfig<any>,\n    sheet,\n  )\n\n  // 3. One MutationObserver for all element instances\n  const observer = observe(tw)\n\n  return function install$<\n    T extends {\n      new (...args: any[]): HTMLElement & {\n        connectedCallback?(): void\n        disconnectedCallback?(): void\n      }\n    },\n  >(BaseElement: T) {\n    return class WithTwindElement extends BaseElement {\n      readonly tw = tw\n\n      override connectedCallback() {\n        super.connectedCallback?.()\n        sheet.connect(this)\n        observer.observe(getShadowRoot(this))\n      }\n\n      override disconnectedCallback() {\n        sheet.disconnect(this)\n        super.disconnectedCallback?.()\n      }\n    }\n  }\n}\n\ndeclare global {\n  // eslint-disable-next-line no-var\n  var ShadyCSS: { nativeShadow: boolean }\n}\n\n/**\n * Whether the current browser supports `adoptedStyleSheets`.\n * @link https://github.com/lit/lit/blob/393e30cf7c7f97712e524df34e7343147055fc5d/packages/reactive-element/src/css-tag.ts#L13\n */\nconst supportsAdoptingStyleSheets =\n  typeof ShadowRoot !== 'undefined' &&\n  (typeof ShadyCSS === 'undefined' || ShadyCSS.nativeShadow) &&\n  'adoptedStyleSheets' in Document.prototype &&\n  'replace' in CSSStyleSheet.prototype\n\nfunction getShadowRoot(element: HTMLElement): ShadowRoot {\n  return element.shadowRoot || element.attachShadow({ mode: 'open' })\n}\n\ninterface AdoptableSheet extends Sheet<CSSStyleSheet> {\n  connect(element: HTMLElement): void\n  disconnect(element: HTMLElement): void\n}\n\nfunction adoptable(): AdoptableSheet {\n  // TODO: search for SSR stylesheet\n  if (supportsAdoptingStyleSheets) {\n    try {\n      // Try using adoptedStyleSheets — not supported in all browsers\n      const sheet = cssom(new CSSStyleSheet()) as AdoptableSheet\n\n      sheet.connect = (element) => {\n        const shadowRoot = getShadowRoot(element)\n        shadowRoot.adoptedStyleSheets = [...shadowRoot.adoptedStyleSheets, sheet.target]\n      }\n\n      sheet.disconnect = noop\n\n      return sheet\n    } catch {\n      // ignore — continue with fallback\n    }\n  }\n\n  // Fallback: create a dedicated stylesheet for each element instance\n\n  // Create our base stylesheet — its css rules will be copied to each element style\n  const style = document.createElement('style')\n  // Prevent this style sheet from being applied anywhere\n  style.media = 'not all'\n  document.head.prepend(style)\n\n  const sheets = [cssom(style)]\n\n  /** @type {WeakMap<HTMLElement, import('@twind/core').Sheet>} */\n  const sheetsByElement = new WeakMap()\n\n  return {\n    get target() {\n      return sheets[0].target\n    },\n\n    snapshot() {\n      const restores = sheets.map((sheet) => sheet.snapshot())\n      return () => restores.forEach((restore) => restore())\n    },\n\n    clear() {\n      sheets.forEach((sheets) => sheets.clear())\n    },\n\n    destroy() {\n      sheets.forEach((sheets) => sheets.destroy())\n    },\n\n    insert(css, index, rule) {\n      // We first insert the rule into our base sheet\n      // This call will check (try-catch) and warn if necessary\n      sheets[0].insert(css, index, rule)\n\n      // For all connected sheets we insert the resulting rule directly\n      // by-passing the try-catch block\n      const cssRule = this.target.cssRules[index]\n      sheets.forEach(\n        (sheets, notFirst) => notFirst && sheets.target.insertRule(cssRule.cssText, index),\n      )\n    },\n\n    resume(addClassName, insert) {\n      return sheets[0].resume(addClassName, insert)\n    },\n\n    connect(element) {\n      const style = document.createElement('style')\n      getShadowRoot(element).appendChild(style)\n\n      const sheet = cssom(style)\n\n      // Directly copy all rules from our base sheet\n      const { cssRules } = this.target\n      for (let i = 0; i < cssRules.length; i++) {\n        sheet.target.insertRule(cssRules[i].cssText, i)\n      }\n\n      sheets.push(sheet)\n      sheetsByElement.set(element, sheet)\n    },\n\n    disconnect(element) {\n      const index = sheets.indexOf(sheetsByElement.get(element))\n      if (index >= 0) {\n        sheets.splice(index, 1)\n      }\n    },\n  }\n}\n"],"names":["twind","withWebComponents","core","extends_","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","supportsAdoptingStyleSheets","ShadowRoot","ShadyCSS","nativeShadow","Document","CSSStyleSheet","getShadowRoot","element","shadowRoot","attachShadow","mode","config","isProduction","sheet","adoptable","cssom","connect","adoptedStyleSheets","disconnect","noop","style","document","createElement","media","head","prepend","sheets","sheetsByElement","WeakMap","snapshot","restores","map","forEach","restore","clear","destroy","insert","css","index","rule","cssRule","cssRules","notFirst","insertRule","cssText","resume","addClassName","appendChild","push","set","indexOf","get","splice","tw","_extends","hash","observer","observe","BaseElement","connectedCallback","disconnectedCallback"],"mappings":"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"}